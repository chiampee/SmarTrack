#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# GitGuardian secret scanning
echo "üîí Scanning for secrets with GitGuardian..."
if command -v ggshield >/dev/null 2>&1; then
  ggshield secret scan pre-commit || {
    echo "‚ùå GitGuardian found secrets in your code. Please remove them before committing."
    exit 1
  }
elif command -v pipx >/dev/null 2>&1; then
  pipx run ggshield secret scan pre-commit || {
    echo "‚ùå GitGuardian found secrets in your code. Please remove them before committing."
    exit 1
  }
else
  echo "‚ö†Ô∏è  GitGuardian CLI not found. Install with: pip install ggshield or pipx install ggshield"
  echo "   Skipping secret scan for now. Consider installing GitGuardian CLI for local protection."
fi

# Lint staged files
npx lint-staged
